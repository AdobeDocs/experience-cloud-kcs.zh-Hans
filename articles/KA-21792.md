---
title: “GraphQL处理空值的更改 | AEM
description: 描述
solution: Experience Manager as a Cloud Service
product: Experience Manager as a Cloud Service
applies-to: "Experience Manager as a Cloud Service"
keywords: "KCS，Adobe Experience Manager,GraphQL"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Victoria Barnato
article-created-date: "5/9/2023 3:38:29 PM"
article-published-by: Victoria Barnato
article-published-date: "5/9/2023 3:42:59 PM"
version-number: 14
article-number: KA-21792
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=24a8cc86-7fee-ed11-8849-6045bd0065b6"
source-git-commit: 73c9234de4e5bbeb48b0c1ad04d9be38b2f225ce
workflow-type: tm+mt
source-wordcount: '692'
ht-degree: 1%

---

# GraphQL处理空值的更改 | AEM

## 描述 {#description}


<b>环境</b>
Experience Manageras a Cloud Service

<b>问题/症状</b>
在2023.02.11382版中，GraphQL（开源查询语言）实施进行了一些改进，如果实施依赖于旧版本的错误行为，则可能会导致应用程序代码中出现意外行为。 以下提及的解决方案有助于实现Adobe Experience Manager(AEM)GraphQL现在在所有过滤器操作中以一致的空值返回内容。




## 解决方法 {#resolution}

<b>`CONTAINS_NOT` 和 *null* 值</b><br> <br>第一项更改会影响利用 `CONTAINS_NOT` 运算符。 在以前的版本中， `CONTAINS_NOT` 未返回包含 *null* 值。 这与类似的运算符不一致，例如 `EQUALS_NOT` 或 `NOT_AT`.<br>请确保您的客户端应用程序能够处理 *null* AEM在使用 `CONTAINS_NOT`.<br> <br><b>示例:</b>

| <b>过滤器片段</b> | <b>数据</b> | <b>2023.02.11382之前的结果</b> | <b>结果从2023.02.11382开始</b> |
| --- | --- | --- | --- |
| myField:{<br>    值：&quot;frag&quot;, <br>    _op:CONTAINS_NOT<br>} | `[` <br>    {<br>        myField:null<br>    }, <br>    {<br>        myField:&quot;某些文本&quot;<br>    },<br>    {<br>        myField:&quot;文本片段&quot;<br>    }<br>`]` | `[` <br>    {<br>        myField:&quot;某些文本&quot;<br>    }<br>`]` | `[` <br>    {<br>        myField:null<br>    },<br>    {<br>        myField:&quot;某些文本&quot;<br>    }<br>`]` |

<b>应用模式 `ALL_OR_EMPTY/ALL` 和 *null* 值</b>
在2023.02.11382中修复的另一个问题与 *null* 值。 应用模式 `ALL_OR_EMPTY` （在数组/多值字段上）未返回片段 *null* 值，因此它实际上会按您预期的 `ALL` 应用方法。 同时，使用应用模式筛选多值字段 `ALL` 将包含该字段具有空内容的片段，但不应包含该片段。建议测试使用其中一种应用模式的查询，如果查询不再返回2023.02.11382中的预期结果集，则对其进行更改。

请注意，问题仅存在一些运算符(2023.02.11382之前)。
例如： `EQUALS_NOT` 按应用方法预期工作 `ALL_OR_EMPTY`，而 `CONTAINS` 没有。
<b>示例：</b>

| <b>过滤器片段</b> | <b>数据</b> | <b>2023.02.11382之前的结果</b> | <b>结果从2023.02.11382开始</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _表达式：{<br>    值：&quot;1.3&quot;<br>    _运算符：EQUALS_NOT<br>    _应用：全部<br>  }<br>} | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  “1.1”、“1.2”、“1.3” `]` <br>  },<br>  {<br>    myArray: `[`  “2.1”、“2.2”、“2.3” `]` <br>  }<br>`]` | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  “2.1”、“2.2”、“2.3” `]` <br>  }<br>`]` | `[` <br>  {<br>    myArray: `[`  “2.1”、“2.2”、“2.3” `]` <br>  }<br>`]` |
| myArray:{<br>  _表达式：{<br>    值：&quot;2&quot;<br>    _运算符：包含<br>    _应用：ALL_OR_EMPTY<br>  }<br>} | `[` <br>  {<br>    myArray: `[`  “2.1”、“2.2”、“2.3” `]` <br>  }<br>`]` | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  “2.1”、“2.2”、“2.3” `]` <br>  }<br>`]` |

<b>应用模式： `INSTANCES`, `_instances: 0` 和 *null* 值</b>
最后一个问题也与 *null* 值。 应用模式 `INSTANCES` with`_instances: 0` 不匹配包含的内容片段 *null* 值在2023.02.11382之前的相应字段中，但将从2023.02.11382开始。建议测试使用此星座图的查询，如果查询不再返回2023.02.11382中的预期结果集，则对其进行更改。
<b>示例：</b>

| <b>过滤器片段</b> | <b>数据</b> | <b>2023.02.11382之前的结果</b> | <b>结果从2023.02.11382开始</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _表达式：{<br>    值：&quot;2&quot;<br>    _运算符：包含<br>    _应用：实例<br>    _实例：0<br>  }<br>} | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  “1.1”、“1.2”、“1.3” `]` <br>  },<br>  {<br>    myArray: `[`  “2.1”、“2.2”、“2.3” `]` <br>  }<br>`]` | `[` <br>  {<br>    myArray: `[`  “1.1”、“1.2”、“1.3” `]` <br>  }<br>`]` | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  “1.1”、“1.2”、“1.3” `]` <br>  }<br>`]` |

<b>可能会影响 `ft-sites-97` 已启用</b>
拥有 `ft-sites-97`*(GraphQL分页和优化过滤)* 已启用功能标志 *之前*升级到2023.02.11382后，版本2023.02.11382可能会遇到以下行为更改中的一个或多个。未启用此功能标志的客户不会受到此部分的影响。
<b>对检查非等式的条件进行空处理</b>
片段字段 *null* 值间歇性不匹配正在检查是否不相等的过滤器。

如果您的代码依赖于未返回的这些片段，则必须调整代码以适应预期行为。


| <b>过滤器片段</b> | <b>数据</b> | <b>中间实施的结果</b> | <b>最终实施的结果</b> |
| --- | --- | --- | --- |
| myField:{<br>  值：“一些文字”，<br>  _op:EQUALS_NOT<br>} | `[` <br>  {<br>    myField:null<br>  },<br>  {<br>    myField:&quot;某些文本&quot;<br>  },<br>  {<br>    myField:&quot;文本片段&quot;<br>  }<br>`]` | `[` <br>  {<br>    myField:&quot;某些文本&quot;<br>  }<br>`]` | `[` <br>  {<br>    myField:null<br>  },<br>  {<br>    myField:&quot;某些文本&quot;<br>  }<br>`]` |

<b>过滤器运算符 `NOT_AT` 包含日期/时间值</b>
过滤器运算符 `NOT_AT` 间歇性无法正确使用数据/时间值。 相反，它的工作方式更像 `AFTER` 条件。 
如果您的代码依赖于不正确的行为，则应将筛选条件切换为 `AFTER`.
<b>阵列： `INSTANCES` with `_instances: 0` 无法正常工作</b>
筛选条件 `INSTANCES` （在数组/多值字段上） `_instances` 设置为0时，间歇性无法按预期工作，但不会返回实际应具有的任何位置。

受此问题影响的过滤器片段如下所示： `doubleArray: { _expressions: { value: 0, _operator: GREATER, _apply: INSTANCES, _instances: 0 } }`

如果您依赖的是错误行为，则需要重写查询以返回与之前相同的结果。


| <b>过滤器片段</b> | <b>数据</b> | <b>中间实施的结果</b> | <b>最终实施的结果</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _表达式：{<br>    值：20<br>    _运算符：等于<br>    _应用：实例<br>    _实例：0<br>  }<br>} | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  10, 20, 30 `]` <br>  },<br>  {<br>    myArray: `[`  11、12、13 `]` <br>  }<br>`]` | `[`  `]` | `[` <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray: `[`  11、12、13 `]` <br>  }<br>`]` |

