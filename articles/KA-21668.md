---
title: 已通过AccessDeniedException阻止分发队列
description: 描述
solution: Experience Manager as a Cloud Service,Experience Manager
product: Experience Manager as a Cloud Service,Experience Manager
applies-to: Experience Manager as a Cloud Service,Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: See https://jira.corp.adobe.com/browse/SKYOPS-53409
bug: false
article-created-by: Zita Rodricks
article-created-date: 4/11/2023 6:07:30 PM
article-published-by: Krunal Oza
article-published-date: 5/3/2023 3:35:49 PM
version-number: 6
article-number: KA-21668
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=0e63beb4-93d8-ed11-a7c7-6045bd006079
exl-id: 371e30df-9c45-4df6-91df-d5e52f252f0c
source-git-commit: 1d3108b38634fd818149cc5f084a617ff74edfe1
workflow-type: tm+mt
source-wordcount: '558'
ht-degree: 1%

---

# 已通过AccessDeniedException阻止分发队列

## 描述 {#description}

<b>环境</b>
- Experience Manager
- Experience Manager as a cloud service



<b>问题/症状</b><br>当尝试使用“快速发布”、“管理发布”或“复制”复制某些页面内容（或XF和其他类型的资源）时，作者上的分发队列将获得 <b>已阻止</b>.<br> <br>可以通过检查 *发布*&#x200B;分发UI中的分发队列(AEM — 工具 — 部署 — 分发)：<br>![](assets/___1863beb4-93d8-ed11-a7c7-6045bd006079___.png)<br> <br>选择Golden Publisher队列（列表中的粗体条目），将提供更多详细信息，特别是所涉及的内容 <b>路径</b> （此处可能有多个元素）：<br>![](assets/___2363beb4-93d8-ed11-a7c7-6045bd006079___.png)<br> <br>查看 <b>日志</b> 选项卡将显示以下相应错误：<br>2023/03/08 12:11:26:238 - INFO — 使用分发包PackageMessage(pubSlingId=a1133c97-6809-411e-a435-4eea0ecbe889， reqType=ADD， pkgId=dstrpck-1678277486031-63159f4b-c577-4079-8741-d41660597d20， pkgType=journal_fileval ault， pkgLength=6330， pubAgentName=publish， userId=replication-service， paths=/content/wknd/fr， deepPaths=) at offset=158705 2023/03/08 12:11:27:459 - WARN — 消息：尝试导入分发包PackageMessage(pubSlingId=a1133c97-6809-411e-a435-4eea0ecbe889， reqType=ADD， pkgId=dstrpck-1678277486031-63159f4b-c577-4079-8741-d41660597d20失败pkgType=journal_filevault， pkgLength=6330， pubAgentName=publish， userId=replication-service， paths=/content/wknd/fr， deepPaths=) at offset=158705，原因是“javax.jcr.AccessDeniedException： OakAccess000：Access被拒绝”，导入程序将稍后重试，Stacktrace： org.apache.sling.distribuiling.distribution.common.DistributionException： javax.javax.jcr.jcr.AccessDenitionDenitionExceptionException： Access0 000：访问被拒绝……<br> <br>您需要 *清除队列* （或删除该项目）以取消阻止队列。

## 解决方法 {#resolution}


尽管出现错误 <b>`javax.jcr.AccessDeniedException`</b>，则可能与分发服务用户的ACL/权限无关，但如果以下情况不适用于您的情况，则应考虑这一点。



诊断

在某些情况下，当复制的内容确实具有与特殊目录相关的特定配置时，可能会出现上述错误 <b>jcr：lockIsDeep</b> 属性。

为了确认诊断，您必须检查 <b>每个提及的路径</b> ，并提供以下任何您可访问/适用的工具：

1. 适用于开发实例的CRX/DE
2. 该 [存储库浏览器](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/content/implementing/developer-tools/repository-browser.html?lang=zh-Hans)
3. 在包管理器中创建内容包（此选项也是解决方案的一部分）


然后您需要检查 <b>`jcr:content`</b> 分发队列UI中找到的每个路径的节点，并验证是否：

- It <b>是 </b>有一个 <b>`jcr:lockIsDeep`=&quot;(Boolean)true&quot;</b> 属性
- It <b>不会 </b>有一个 <b>`jcr:lockOwner="xxx"`</b> 属性
- <b>(</b>it <b>不会</b> 有一个 <b>`mix:lockable`</b> 中的值 <b>`jcr:mixinTypes`</b>)


![](assets/e5fb7aa2-d8bd-ed11-83ff-6045bd0065b6.png)

如果是这种情况，问题将得到确认，因为 <b>`jcr:lockIsDeep`</b> 属性不应单独存在。 此属性应始终与 <b>`jcr:lockOwner`</b> 时间 <b>锁定</b> 一个页面。

不能只设置 <b>`jcr:lockIsDeep`</b> 属性，即使使用JCR API，因此解释此情况的根本原因主要是使用单个属性安装了“损坏的”内容包。



<u><b>分辨率</b></u>

要修复内容，唯一的解决方案是在作者中安装包，该包在相应节点上设置了正确的属性。

您可以从具有相应内容的另一个实例创建包，或者，如果受影响的实例上只有此内容，则可以按照以下说明进行操作：

1. 在已损坏的实例上为错误页面生成包
2. 下载包
3. 提取 <b>`.content.xml`</b> 对于page/jcr：content
4. 使用手动删除行 <b>jcr：lockIsDeep</b>
5. 使用新的/修复的.content.xml更新包
6. 重新上传并安装修改后的包


然后，您可以再次检查页面属性，并成功测试复制/分发。
