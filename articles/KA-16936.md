---
title: 当通过SSL/TLS终止的负载平衡器进行访问时，AEM会将用户重定向回http | AEM
description: 描述
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/AEM-redirecting-back-to-http-on-accessed-via-SSL-terminated-Load-Balancer.html"
bug: false
article-created-by: Emily Geary
article-created-date: "4/12/2021 6:21:34 PM"
article-published-by: Emily Geary
article-published-date: "4/12/2021 6:26:15 PM"
version-number: 1
article-number: KA-16936
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=684ec8e8-bb9b-eb11-b1ac-000d3a3680d8"
exl-id: 52e50c09-67f2-46a2-90a7-df769d76a0dd
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '341'
ht-degree: 1%

---

# 当通过SSL/TLS终止的负载平衡器进行访问时，AEM会将用户重定向回http | AEM

## 描述


当通过SSL终止的负载平衡器（或SSL终止的CDN）访问AEM时，AEM会将https重定向回http。

负载平衡器上的SSL终止意味着SSL证书已安装在负载平衡器中。 最终用户通过访问网站 `https://`，且在后端使用 `http://`.



<b>原因</b>

不同的负载平衡器会发送不同的标头，以通知后端系统SSL在上游终止。 例如， [Amazon ELB使用标头“X-Forwarded-Proto:https&quot;](https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/x-forwarded-headers.html#x-forwarded-proto).


## 分辨率


要修复此问题，请执行以下操作：

<b>一、更新调度程序 `/clientheaders` 配置</b>

请参阅负载平衡器的文档，以了解它设置哪个标头来通知下游系统它已终止SSL。 为简单起见，在这些步骤中，我们假定正确的HTTP标头是 *`X-Forwarded-Proto: https`*

1. 登录到调度程序服务器。
2. 打开调度程序场 `.any` 配置。
3. 将标题添加到 `/clientheaders` 中。


如果您使用的调度程序没有负载平衡器，或者您的负载平衡器或代理无法设置 `X-Forwarded-Proto` 标头，则可以在web服务器或调度程序级别设置。 如果您使用 [!DNL Apache HTTP Server]，然后使用以下指令更新您的HTTPS VirtualHost:


| 1 | `RequestHeader ` `set` `X-Forwarded-Proto ` `"https"` |
| --- | --- |


<b>二。 更新标头配置：</b>

1. 转到 *http://host:port*/system/console/configMgr/org.apache.felix.http.sslfilter.SslFilter，并以管理员身份登录。
2. 将SSL转发标头设置为 `X-Forwarded-Proto`.
3. 将SSL转发值设置为https。
4. 单击保存。


注释：

反向代理标头没有标准来告知后端使用哪种协议。 但是，以下是一些已知的：

- Amazon ELB([!DNL Elastic Load Balancer])使用 `X-Forwarded-Proto: https` 标题。
- [!DNL Amazon Cloudfront] CDN使用 `X-Cloudfront-Proto: https` 标题。


<b>三。 更新Jetty OSGi配置(AEM 6.3及更高版本)</b>

在AEM 6.3及更高版本上，需要添加以下配置：

- 登录到http://aem-host:port/system/console/configMgr/org.apache.felix.http。
- 启用设置 <b>启用代理/负载平衡器连接</b>，然后保存。
