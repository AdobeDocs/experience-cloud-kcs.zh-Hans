---
title: '"如何重新索引同步AEM索引 | AEM, Oak”'
description: 描述
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:19:48 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:21:41 PM"
version-number: 2
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=3613fb7d-6687-eb11-a812-000d3a593216"
exl-id: 1209609f-84a9-4810-b7c8-1193b09f82d7
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '412'
ht-degree: 0%

---

# 如何重新索引同步AEM索引 | AEM、Oak

## 描述


如何在不导致停机的情况下正确重新索引同步Oak索引？


## 分辨率


只需将reindex属性设置为true即可重新索引同步索引，这会导致同步操作导致Oak实例挂起。 要避免这种情况，请将索引发送到后台线程。  为此，请执行以下步骤：

<b>步骤1:</b> 在后台线程中重新编入索引

1. 在CRXDE Lite定义的索引中设置以下属性，以便启用异步索引 —  `/oak:index/property` 索引

   `reindex=true`

   `reindex-async=true`
2. 要验证以上刷新节点，请 `async="async-reindex"` 应设置。
3. 调用 `startPropertyIndexAsyncReindex` 在 `PropertyIndexAsyncReindex` MBean。 这将启动后台作业，该作业将搜索此类类型的索引。 调用后，您应会看到日志行将执行重新索引……
4. 完成重新索引后，重新索引标记将重置为false。
5. 重新调用步骤3，将索引更改回同步索引。 如果未删除异步标记，则可能必须多次调用Mbean（如果同时发生更改影响此索引，则可能会发生这种情况）。



*注意：* 仅 `async="async-reindex"` 将被删除，因为该控件控制将在哪个线程上进行索引。  的 `reindex-async` 属性只是一个不会自动更改的配置标记。 其思想是，您只需为特定索引定义设置一次该索引，以控制所有将来的重新索引。 然后，人们就认为它会留在那里，然后你就不需要再碰它了。


<b>步骤2:</b> 删除重新索引检查点(仅限AEM 6.2及更早版本)

在异步重新索引过程中，会创建存储库检查点。 索引任务完成后，必须按如下所述发布该任务，以确保以后顺利地收集修订垃圾：

1. 首先，打开CheckpointManager MBean:

   MongoMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3Document+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   TarMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)
2. 调用 `listCheckpoints()` 操作
3. 查找包含 `name=async-reindex` 属性。
4. 将其ID值复制到剪贴板

   在MongoMK中，它将类似于： `r1234567aaaa-0-1`

   在TarMK中，它将类似于： `6eac07d0-fe27-4d16-82f8-6d5da4cefd67`
5. 然后，打开 `releaseCheckpoint()` 操作。
6. 将复制的ID粘贴为p1，然后单击“调用”。
7. 此步骤将发布检查点。
